<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Valentine</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300;14..32,400;14..32,500;14..32,600&display=swap" rel="stylesheet">
  <style>
    /* ===== GLOBAL ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(145deg, #e7d6c3 0%, #d6bda1 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      color: #3b2e23;
      position: relative;
      overflow-x: hidden;
    }
    #particle-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }
    /* ===== CARD UTAMA ===== */
    .card {
      max-width: 1000px;
      width: 100%;
      background: rgba(255, 251, 245, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 48px 24px 48px 24px;
      box-shadow: 0 30px 50px -20px rgba(60, 40, 20, 0.4),
                  0 8px 0 0 #b48c63 inset,
                  0 0 0 1px #f0e1cf inset;
      overflow: hidden;
      padding: 1.8rem 1.8rem 2.2rem;
      position: relative;
      z-index: 10;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 35px 55px -20px rgba(60, 40, 20, 0.5), 0 8px 0 0 #b48c63 inset;
    }
    .hero-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      align-items: center;
    }
    .greeting {
      padding-right: 0.5rem;
    }
    .greeting h1 {
      font-size: clamp(2.2rem, 5vw, 3.2rem);
      font-weight: 600;
      line-height: 1.2;
      letter-spacing: -0.02em;
      color: #4a3727;
      margin-bottom: 1.5rem;
      position: relative;
    }
    .greeting h1::after {
      content: '';
      display: block;
      width: 80px;
      height: 4px;
      background: #b48c63;
      margin-top: 0.75rem;
      border-radius: 4px;
      transition: width 0.3s;
    }
    .card:hover .greeting h1::after {
      width: 120px;
    }
    .greeting p {
      font-size: 1.2rem;
      line-height: 1.6;
      color: #5f4a36;
      font-weight: 300;
      max-width: 90%;
      margin-bottom: 2rem;
    }
    .detail {
      display: flex;
      gap: 1.2rem;
      font-size: 1rem;
      color: #8b6f50;
      border-top: 1px dashed #dbbd9f;
      padding-top: 1.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    .detail span {
      background: rgba(180, 140, 99, 0.1);
      padding: 0.3rem 1rem;
      border-radius: 30px;
      backdrop-filter: blur(2px);
    }
    /* ===== SLIDESHOW ===== */
    .visual {
      position: relative;
      border-radius: 36px 18px 36px 18px;
      overflow: hidden;
      box-shadow: 0 20px 30px -12px #7a5e44;
      aspect-ratio: 1 / 1.1;
      background: #e9d9c6;
      touch-action: pan-y;
      width: 100%;
    }
    .slideshow {
      width: 100%;
      height: 100%;
      position: relative;
      background: #dccfbe;
    }
    .slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 0.6s ease;
      border-radius: inherit;
      pointer-events: none;
      background: #cbb59b;
    }
    .slide.active {
      opacity: 1;
      z-index: 2;
    }
    .caption {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      text-align: center;
      color: white;
      font-size: 1.1rem;
      font-weight: 400;
      text-shadow: 0 2px 8px rgba(0,0,0,0.2);
      background: linear-gradient(to top, rgba(60,40,20,0.7), transparent);
      padding: 30px 20px 65px;
      z-index: 5;
      opacity: 0;
      transition: opacity 0.4s;
      pointer-events: none;
    }
    .caption.show {
      opacity: 1;
    }
    .dots {
      position: absolute;
      bottom: 25px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 15;
      background: rgba(255, 245, 235, 0.7);
      backdrop-filter: blur(4px);
      padding: 8px 18px;
      border-radius: 40px;
      border: 1px solid rgba(150, 100, 60, 0.3);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .dot {
      width: 10px;
      height: 10px;
      background: #c1a384;
      border-radius: 20px;
      border: none;
      padding: 0;
      cursor: pointer;
      transition: all 0.3s;
    }
    .dot.active-dot {
      background: #5e3f28;
      width: 28px;
    }
    /* ===== KUCING + NAMETAG ===== */
    .cats-container {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 180px;
      pointer-events: none;
      z-index: 30;
    }
    .cat {
      position: absolute;
      bottom: 0;
      width: 90px;
      height: 90px;
      pointer-events: auto;
      cursor: pointer;
      filter: drop-shadow(0 8px 12px rgba(100, 60, 20, 0.3));
      will-change: left, transform;
      transition: left 0.3s linear;
      z-index: 30;
    }
    /* Animasi lompat halus */
    @keyframes smoothJump {
      0% { transform: translateY(0); }
      30% { transform: translateY(-28px); }
      50% { transform: translateY(-20px); }
      70% { transform: translateY(-8px); }
      100% { transform: translateY(0); }
    }
    .cat.jump {
      animation: smoothJump 0.5s ease-out;
    }
    /* Nametag di atas kepala */
    .nametag {
      position: absolute;
      top: -35px;          /* di atas kepala */
      left: 50%;
      transform: translateX(-50%);
      background: #fff2e5;
      color: #7a5a3a;
      font-size: 0.7rem;
      font-weight: 600;
      padding: 4px 12px;
      border-radius: 30px;
      white-space: nowrap;
      border: 1px solid #dbbd9f;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      pointer-events: none;  /* agar tidak mengganggu klik */
      z-index: 35;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }
    /* Bubble chat */
    .speech-bubble {
      position: absolute;
      top: -18px;
      left: 88px;
      background: #fff7ed;
      color: #5e3f28;
      padding: 6px 14px;
      border-radius: 30px 30px 30px 5px;
      font-size: 0.9rem;
      white-space: nowrap;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      border: 1px solid #dbbd9f;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      z-index: 40;
    }
    /* Badan kucing (dari kode sebelumnya) */
    .cat-body {
      width: 90px;
      height: 90px;
      border-radius: 50% 50% 30% 30%;
      position: relative;
      box-shadow: 0 6px 0 rgba(0,0,0,0.2);
    }
    .cat-ear {
      position: absolute;
      top: -8px;
      width: 22px;
      height: 27px;
      clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
    }
    .ear-left { left: 10px; transform: rotate(-10deg); }
    .ear-right { right: 10px; transform: rotate(10deg); }
    .cat-face {
      position: absolute;
      top: 25px;
      left: 22px;
      width: 46px;
      height: 32px;
    }
    .eye {
      position: absolute;
      width: 9px;
      height: 9px;
      background: #f5e6d3;
      border-radius: 50%;
      top: 5px;
    }
    .eye-left { left: 7px; }
    .eye-right { right: 7px; }
    .pupil {
      width: 4px;
      height: 4px;
      background: #3b2e23;
      border-radius: 50%;
      margin: 2.5px auto;
    }
    .nose {
      position: absolute;
      top: 14px;
      left: 19px;
      width: 8px;
      height: 7px;
      background: #ffb6c1;
      border-radius: 50%;
    }
    .whiskers {
      position: absolute;
      top: 20px;
      left: 0;
      width: 100%;
      height: 2px;
    }
    .whisker {
      position: absolute;
      width: 22px;
      height: 1.5px;
      background: #5e4a36;
    }
    .whisker-left1 { left: -16px; top: -3px; transform: rotate(-5deg); }
    .whisker-left2 { left: -16px; top: 3px; transform: rotate(5deg); }
    .whisker-right1 { right: -16px; top: -3px; transform: rotate(5deg); }
    .whisker-right2 { right: -16px; top: 3px; transform: rotate(-5deg); }
    .cat-tail {
      position: absolute;
      right: -16px;
      bottom: 18px;
      width: 32px;
      height: 16px;
      border-radius: 50% 20% 0 0;
      transform: rotate(15deg);
    }
    .cat-brown .cat-body, .cat-brown .cat-ear, .cat-brown .cat-tail {
      background: #8b6f50;
    }
    .cat-garfield .cat-body, .cat-garfield .cat-ear, .cat-garfield .cat-tail {
      background: #f39c12;
    }
    .cat-garfield .cat-body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(45deg, rgba(0,0,0,0.1) 0px, rgba(0,0,0,0.1) 5px, transparent 5px, transparent 10px);
      border-radius: inherit;
      pointer-events: none;
    }
    .cat-blackwhite .cat-body {
      background: linear-gradient(90deg, #fff 50%, #333 50%);
    }
    .cat-blackwhite .ear-left { background: #fff; }
    .cat-blackwhite .ear-right { background: #333; }
    .cat-blackwhite .cat-tail { background: #333; }
    /* ===== LOVE PARTICLES ===== */
    .love-particle {
      position: fixed;
      font-size: 1.8rem;
      pointer-events: none;
      z-index: 200;
      animation: floatLove 1s ease-out forwards;
    }
    @keyframes floatLove {
      0% { transform: translateY(0) scale(0.8); opacity: 1; }
      100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
    }
    /* ===== MUSIC CONTROL ===== */
    .music-control {
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 100;
      background: rgba(255, 245, 235, 0.8);
      backdrop-filter: blur(6px);
      border-radius: 40px;
      padding: 8px 18px;
      font-size: 0.9rem;
      color: #5e3f28;
      border: 1px solid #dbbd9f;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
      transition: background 0.2s;
    }
    .music-control:hover {
      background: rgba(255, 235, 220, 0.9);
    }
    .footer-note {
      margin-top: 2rem;
      text-align: center;
      font-size: 1rem;
      color: #8f765b;
      font-weight: 300;
      border-top: 1px solid #eddccb;
      padding-top: 1.5rem;
    }
    /* ===== RESPONSIVE ===== */
    @media (max-width: 700px) {
      .hero-grid {
        grid-template-columns: 1fr;
        gap: 1.8rem;
      }
      .greeting {
        text-align: center;
        padding-right: 0;
      }
      .greeting h1::after {
        margin-left: auto;
        margin-right: auto;
      }
      .greeting p {
        max-width: 100%;
        margin-left: auto;
        margin-right: auto;
      }
      .detail {
        justify-content: center;
      }
      .visual {
        max-width: 500px;
        margin: 0 auto;
        width: 100%;
      }
    }
    @media (max-width: 480px) {
      .card {
        padding: 1.5rem 1.2rem 1.8rem;
      }
      .greeting h1 {
        font-size: 2rem;
      }
      .greeting p {
        font-size: 1rem;
      }
      .detail span {
        font-size: 0.9rem;
        padding: 0.2rem 0.8rem;
      }
      .caption {
        font-size: 0.9rem;
        padding: 25px 15px 20px;
      }
      .dots {
        padding: 6px 14px;
        bottom: 20px;
      }
      .nametag {
        font-size: 0.6rem;
        padding: 3px 8px;
        top: -40px;
      }
    }
  </style>
</head>
<body>
  <canvas id="particle-canvas"></canvas>

  <div class="music-control" id="musicToggle">
    <span class="icon">üéµ</span>
    <span id="musicStatus">Musik: mati</span>
  </div>

  <div class="card">
    <div class="hero-grid">
      <div class="greeting">
        <h1>Selamat<br>Hari Valentine Bubub ü§é</h1>
        <p>Untuk hari yang manis, biarkan cinta berbicara ‚Äî seperti sepotong cokelat yang meleleh di hati.</p>
        <div class="detail">
          <span>üç´ chocolate</span>
          <span>üåπ roses</span>
          <span>üíå warmth</span>
        </div>
      </div>
      <div class="visual" id="swipeArea">
        <div class="slideshow" id="slideshow">
          <!-- Gambar placeholder (bisa diganti dengan gambar asli) -->
          <img class="slide" src="/p1.jpg" alt="cokelat dan bunga">
          <img class="slide" src="/p2.jpg" alt="mawar merah">
          <img class="slide" src="/p3.jpg" alt="hadiah cokelat">
          <img class="slide" src="/p4.jpg" alt="boneka beruang">
          <img class="slide" src="/p5.jpg" alt="kue cokelat">
          <img class="slide" src="/p6.png" alt="cokelat dan bunga">
          <img class="slide" src="/p7.png" alt="mawar merah">
          <img class="slide" src="/p8.png" alt="hadiah cokelat">
          <img class="slide" src="/p9.png" alt="boneka beruang">
          <img class="slide" src="/p10.png" alt="kue cokelat">
          <img class="slide" src="/p11.png" alt="luplup">
          <img class="slide" src="/p12.png" alt="mawar merah">
          <img class="slide" src="/p13.png" alt="hadiah cokelat">
          <img class="slide" src="/p14.png" alt="boneka beruang">
          <img class="slide" src="/p15.png" alt="kue cokelat">
          <img class="slide" src="/p16.png" alt="cokelat dan bunga">
          <img class="slide" src="/p17.png" alt="mawar merah">
          <img class="slide" src="/p18.png" alt="hadiah cokelat">
          <img class="slide" src="/p19.png" alt="boneka beruang">
          <img class="slide" src="/p20.png" alt="kue cokelat">
        </div>
        <div class="caption" id="caption">Cokelat dan cinta, paduan manis</div>
        <div class="dots" id="dotsContainer"></div>
      </div>
    </div>
    <div class="footer-note">
      <span>Dengan Sepenuh Hati ü§é</span>
    </div>
  </div>

  <!-- Container untuk tiga kucing -->
  <div class="cats-container" id="catsContainer"></div>

  <!-- Audio -->
  <audio id="meowSound" preload="auto">
    <source src="/meaw.mp3" type="audio/mpeg">
  </audio>
  <audio id="growlSound" preload="auto">
    <source src="/purrr.mp3" type="audio/mpeg">
  </audio>
  <audio id="/bg-music" loop>
    <source src="/bg_sound.mp3" type="audio/mpeg">
  </audio>

  <script>
    (function() {
      // ==================== SLIDESHOW + SWIPE ====================
      const slides = document.querySelectorAll('.slide');
      const dotsContainer = document.getElementById('dotsContainer');
      const captionEl = document.getElementById('caption');
      const swipeArea = document.getElementById('swipeArea');
      let currentIndex = 0;
      let slideInterval;
      const captions = [
        "Cokelat dan cinta, paduan manis",
        "Mawar merah untuk hatimu",
        "Hadiah kecil, makna besar",
        "Beruang yang selalu memeluk",
        "Kue cokelat, manis seperti senyummu",
        "luplup",
        "Cokelat dan cinta, paduan manis",
        "Mawar merah untuk hatimu",
        "Hadiah kecil, makna besar",
        "Beruang yang selalu memeluk",
        "Kue cokelat, manis seperti senyummu",
        "luplup",
        "Cokelat dan cinta, paduan manis",
        "Mawar merah untuk hatimu",
        "Hadiah kecil, makna besar",
        "Beruang yang selalu memeluk",
        "Kue cokelat, manis seperti senyummu",
        "luplup",
        "Cokelat dan cinta, paduan manis",
        "Mawar merah untuk hatimu",
      ];

      function showSlide(index) {
        slides.forEach((s, i) => s.classList.toggle('active', i === index));
        const dots = document.querySelectorAll('.dot');
        dots.forEach((d, i) => d.classList.toggle('active-dot', i === index));
        captionEl.textContent = captions[index];
        captionEl.classList.add('show');
        setTimeout(() => captionEl.classList.remove('show'), 2000);
        currentIndex = index;
      }

      function nextSlide() {
        showSlide((currentIndex + 1) % slides.length);
      }

      function prevSlide() {
        showSlide((currentIndex - 1 + slides.length) % slides.length);
      }

      function startSlideInterval() {
        if (slideInterval) clearInterval(slideInterval);
        slideInterval = setInterval(nextSlide, 5000);
      }

      function createDots() {
        dotsContainer.innerHTML = '';
        for (let i = 0; i < slides.length; i++) {
          const dot = document.createElement('button');
          dot.classList.add('dot');
          if (i === 0) dot.classList.add('active-dot');
          dot.addEventListener('click', () => {
            showSlide(i);
            startSlideInterval();
          });
          dotsContainer.appendChild(dot);
        }
      }
      showSlide(0);
      createDots();
      startSlideInterval();

      swipeArea.addEventListener('mouseenter', () => clearInterval(slideInterval));
      swipeArea.addEventListener('mouseleave', startSlideInterval);

      // Swipe gesture
      let touchStartX = 0;
      let touchEndX = 0;
      const minSwipeDistance = 50;

      swipeArea.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
      }, { passive: true });

      swipeArea.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      }, { passive: true });

      let mouseDown = false;
      swipeArea.addEventListener('mousedown', (e) => {
        mouseDown = true;
        touchStartX = e.screenX;
      });
      swipeArea.addEventListener('mousemove', (e) => {
        if (!mouseDown) return;
        touchEndX = e.screenX;
      });
      swipeArea.addEventListener('mouseup', () => {
        if (mouseDown) {
          handleSwipe();
          mouseDown = false;
        }
      });
      swipeArea.addEventListener('mouseleave', () => {
        mouseDown = false;
      });

      function handleSwipe() {
        const distance = touchEndX - touchStartX;
        if (Math.abs(distance) > minSwipeDistance) {
          if (distance > 0) prevSlide();
          else nextSlide();
          startSlideInterval();
        }
      }

      // ==================== MUSIK ====================
      const audio = document.getElementById('bg-music');
      const musicToggle = document.getElementById('musicToggle');
      const musicStatus = document.getElementById('musicStatus');
      let musicPlaying = false;

      audio.muted = true;
      audio.play().then(() => {
        musicPlaying = true;
        musicStatus.innerText = 'Musik: menyala (mute)';
      }).catch(() => {
        musicStatus.innerText = 'Musik: klik untuk putar';
      });

      musicToggle.addEventListener('click', () => {
        if (musicPlaying) {
          if (audio.muted) {
            audio.muted = false;
            musicStatus.innerText = 'Musik: menyala ‚ô´';
          } else {
            audio.pause();
            musicPlaying = false;
            musicStatus.innerText = 'Musik: mati';
          }
        } else {
          audio.muted = false;
          audio.play().then(() => {
            musicPlaying = true;
            musicStatus.innerText = 'Musik: menyala ‚ô´';
          }).catch(() => alert('Izinkan interaksi untuk memutar musik.'));
        }
      });

      // ==================== PARTIKEL LATAR ====================
      const canvas = document.getElementById('particle-canvas');
      const ctx = canvas.getContext('2d');
      let w, h, particles = [];

      function resizeCanvas() {
        w = window.innerWidth;
        h = window.innerHeight;
        canvas.width = w;
        canvas.height = h;
      }

      function initParticles() {
        particles = [];
        for (let i = 0; i < 25; i++) {
          particles.push({
            x: Math.random() * w,
            y: Math.random() * h,
            size: 2 + Math.random() * 5,
            speedY: 0.1 + Math.random() * 0.2,
            speedX: (Math.random() - 0.5) * 0.1,
            opacity: 0.1 + Math.random() * 0.15,
            color: Math.random() > 0.6 ? '#8b6f50' : '#d4a574',
            shape: Math.random() > 0.9 ? '‚ù§Ô∏è' : '‚Ä¢'
          });
        }
      }

      function drawParticles() {
        ctx.clearRect(0, 0, w, h);
        particles.forEach(p => {
          ctx.globalAlpha = p.opacity;
          if (p.shape === '‚ù§Ô∏è') {
            ctx.font = `${p.size * 3}px 'Inter', sans-serif`;
            ctx.fillStyle = p.color;
            ctx.fillText('‚ù§Ô∏è', p.x, p.y);
          } else {
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size / 2, 0, Math.PI * 2);
            ctx.fillStyle = p.color;
            ctx.fill();
          }
          p.y += p.speedY;
          p.x += p.speedX;
          if (p.y > h + 10) { p.y = -10; p.x = Math.random() * w; }
          if (p.x > w + 10) p.x = -10;
          if (p.x < -10) p.x = w + 10;
        });
        requestAnimationFrame(drawParticles);
      }

      window.addEventListener('resize', () => {
        resizeCanvas();
        initParticles();
      });
      resizeCanvas();
      initParticles();
      drawParticles();

      // ==================== TIGA KUCING + NAMETAG + INTERAKSI ====================
      const catsContainer = document.getElementById('catsContainer');
      const meowAudio = document.getElementById('meowSound');
      const growlAudio = document.getElementById('growlSound');

      // Daftar pesan random
      const randomMessages = [
        "Meow! ‚ù§Ô∏è", "Purrr...", "Aku cinta kamu", "Cuddle?",
        "üêæ", "Valentine!", "üòΩ", "I love you", "cium dong",
        "miaw", "selamat hari kasih sayang", "nyenye", "nyiii", "ü•∞","sentuh aku!"
      ];

      // Data kucing dengan nama untuk nametag
      const catData = [
        { colorClass: 'cat-brown', startLeft: '5%', nama: 'tete' },
        { colorClass: 'cat-garfield', startLeft: '40%', nama: 'Garfield' },
        { colorClass: 'cat-blackwhite', startLeft: '75%', nama: 'ciko' }
      ];

      const cats = [];
      const CAT_WIDTH = 90;

      // Fungsi membuat partikel love di posisi kucing
      function createLoveParticles(catElement) {
        const rect = catElement.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 3;

        for (let i = 0; i < 5; i++) {
          const love = document.createElement('div');
          love.className = 'love-particle';
          love.textContent = '‚ù§Ô∏è';
          love.style.left = (x + (Math.random() - 0.5) * 40) + 'px';
          love.style.top = (y + (Math.random() - 0.5) * 20) + 'px';
          love.style.fontSize = (1.2 + Math.random() * 1) + 'rem';
          love.style.animationDuration = (0.8 + Math.random() * 0.5) + 's';
          document.body.appendChild(love);
          setTimeout(() => love.remove(), 1000);
        }
      }

      // Fungsi untuk melompat (menambahkan class jump dan menghapus setelah animasi)
      function jump(cat) {
        if (!cat.element) return;
        cat.element.classList.add('jump');
        setTimeout(() => {
          cat.element.classList.remove('jump');
        }, 500);
      }

      // Fungsi menampilkan pesan random
      function showRandomMessage(cat) {
        const msg = randomMessages[Math.floor(Math.random() * randomMessages.length)];
        cat.speech.textContent = msg;
        cat.speech.style.opacity = '1';
        setTimeout(() => {
          cat.speech.style.opacity = '0';
        }, 2000);
      }

      // Inisialisasi kucing
      catData.forEach((data, idx) => {
        const catDiv = document.createElement('div');
        catDiv.className = `cat ${data.colorClass}`;
        catDiv.style.bottom = '0px';

        // 1. NAMETAG
        const nameTag = document.createElement('div');
        nameTag.className = 'nametag';
        nameTag.textContent = data.nama;
        catDiv.appendChild(nameTag);

        // 2. SPEECH BUBBLE
        const speechDiv = document.createElement('div');
        speechDiv.className = 'speech-bubble';
        speechDiv.textContent = 'halo';
        catDiv.appendChild(speechDiv);

        // 3. BADAN KUCING
        const bodyDiv = document.createElement('div');
        bodyDiv.className = 'cat-body';
        bodyDiv.innerHTML = `
          <div class="cat-ear ear-left"></div>
          <div class="cat-ear ear-right"></div>
          <div class="cat-face">
            <div class="eye eye-left"><div class="pupil"></div></div>
            <div class="eye eye-right"><div class="pupil"></div></div>
            <div class="nose"></div>
            <div class="whiskers">
              <div class="whisker whisker-left1"></div>
              <div class="whisker whisker-left2"></div>
              <div class="whisker whisker-right1"></div>
              <div class="whisker whisker-right2"></div>
            </div>
          </div>
          <div class="cat-tail"></div>
        `;
        catDiv.appendChild(bodyDiv);

        catsContainer.appendChild(catDiv);

        // Hitung posisi awal
        const startLeftPercent = parseFloat(data.startLeft) / 100;
        let startX = startLeftPercent * window.innerWidth;
        startX = Math.max(-30, Math.min(window.innerWidth - CAT_WIDTH + 30, startX));
        catDiv.style.left = startX + 'px';

        const catState = {
          element: catDiv,
          speech: speechDiv,
          x: startX,
          direction: Math.random() > 0.5 ? 1 : -1,
          speed: 0.3 + Math.random() * 0.5,
          jumpTimer: null,
          messageTimer: null,
          idx: idx
        };

        // Event interaksi: lompat + partikel + suara + bubble
        const interact = (e) => {
          e.preventDefault();
          jump(catState);
          createLoveParticles(catDiv);
          speechDiv.textContent = idx === 1 ? 'purrr...' : 'meow!';
          speechDiv.style.opacity = '1';
          setTimeout(() => { speechDiv.style.opacity = '0'; }, 1500);
          if (idx === 1) growlAudio.play().catch(()=>{});
          else meowAudio.play().catch(()=>{});
        };

        catDiv.addEventListener('mouseenter', interact);
        catDiv.addEventListener('touchstart', interact);

        cats.push(catState);
      });

      // Timer lompat dan pesan random
      cats.forEach(cat => {
        function scheduleJump() {
          const delay = 8000 + Math.random() * 5000;
          cat.jumpTimer = setTimeout(() => {
            jump(cat);
            scheduleJump();
          }, delay);
        }
        scheduleJump();

        function scheduleMessage() {
          const delay = 4000 + Math.random() * 4000;
          cat.messageTimer = setTimeout(() => {
            showRandomMessage(cat);
            scheduleMessage();
          }, delay);
        }
        scheduleMessage();
      });

      // Animasi jalan
      function walkAnimation() {
        cats.forEach(cat => {
          let newX = cat.x + cat.direction * cat.speed;
          const minX = -30;
          const maxX = window.innerWidth - CAT_WIDTH + 30;

          if (newX < minX) {
            newX = minX;
            cat.direction = 1;
          } else if (newX > maxX) {
            newX = maxX;
            cat.direction = -1;
          }

          cat.x = newX;
          cat.element.style.left = newX + 'px';
        });
        requestAnimationFrame(walkAnimation);
      }
      walkAnimation();

      window.addEventListener('resize', () => {
        cats.forEach(cat => {
          const maxX = window.innerWidth - CAT_WIDTH + 30;
          const minX = -30;
          let x = cat.x;
          if (x < minX) x = minX;
          if (x > maxX) x = maxX;
          cat.x = x;
          cat.element.style.left = x + 'px';
        });
      });

      window.addEventListener('beforeunload', () => {
        cats.forEach(cat => {
          if (cat.jumpTimer) clearTimeout(cat.jumpTimer);
          if (cat.messageTimer) clearTimeout(cat.messageTimer);
        });
      });
    })();
  </script>
</body>
</html>
